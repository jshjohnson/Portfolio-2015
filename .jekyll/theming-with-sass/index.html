<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
    <meta charset="utf-8">
    <title>Theming with Sass - Josh Johnson - Front-end Developer</title>
    <meta name="description" itemprop="description" content="Experimenting with new Sass features such as Sass Maps that can make theming large-scale, object-oriented projects more pragmatic.">
    <meta name="viewport" content="width=device-width,initial-scale=1, minimal-ui">
    <meta name="twitter:site" content="@jshjohnson">
    <meta name="twitter:creator" content="@jshjohnson">
    <meta name="twitter:title" content="Theming with Sass">
    <meta name="twitter:description" content="Experimenting with new Sass features such as Sass Maps that can make theming large-scale, object-oriented projects more pragmatic.">
    <meta itemprop="name" content="Theming with Sass">
    <meta itemprop="description" content="Experimenting with new Sass features such as Sass Maps that can make theming large-scale, object-oriented projects more pragmatic.">

    <!--[if !IE]><!-->
    <link rel="stylesheet" href="/assets/css/screen.css" media="screen">
    <!--<![endif]-->

    <!--[if (lt IE 9) & (!IEMobile)]>
        <link rel="stylesheet" href="/assets/css/ie.css" media="screen">
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <![endif]-->

    <link rel="apple-touch-icon" sizes="57x57" href="/assets/img/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/assets/img/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/img/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/img/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/img/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/img/apple-touch-icon-120x120.png">
    <link rel="icon" type="image/png" href="/assets/img/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/assets/img/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/assets/img/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/assets/img/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="theme-color" content="#ffffff">
</head>
<body>
<header class="header" id="top">
    <div class="container container--relative">
        <div class="grid">
            <div class="intro grid__cell unit-1-2--bp2">
                <h1 class="intro__heading">
                    <a href="/">Joshua Johnson</a>
                </h1>
                <h2 class="intro__subheading">
                    Front-end Dev Lead @ <a href="http://browserlondon.com" class="intro__link">Browser London</a>
                </h2>
            </div>
            <nav class="nav nav--primary grid__cell unit-1-2--bp2">
                <ul class="nav__list">
                    <li class="nav__item nav__item--active">
                        <a href="/" class="nav__link">Blog</a>
                    </li>
                    <li class="nav__item">
                        <a href="https://twitter.com/jshjohnson" class="nav__link">Twitter</a>
                    </li> 
                </ul>
            </nav>
        </div>
    </div>
</header>
    <main class="post">
        <div class="container">
            <div class="grid text-center">
                <article class="post__item post__item--single grid__cell unit-3-5--bp4 unit-3-4--bp3">
                    <div class="post__wrapper">
                        <header class="post__header">
                            <time datetime="2015-03-02 21:26:05 +0000" class="post__date">
                                
                                2nd
                                    
                                March 2015
                            </time>
                            <h1 class="post__heading">Theming with Sass</h1>
                            <a href="http://twitter.com/share?text=Theming with Sass&url=" class="ribbon">
                                 <img src="/assets/img/share.svg" class="ribbon__inner">
                            </a>
                        </header>
                        
                        
                        <p><span class="drop-cap"><span class="drop-cap__inner">F</span></span>or any large-scale project, maintaining clean, organised CSS is by no means easy. Handling file imports or using variables for example are both crucial pieces to the scalable-style-sheet-puzzle™; both of which vanilla CSS cannot handle well if at all. </p>
<p>Through no fault of their own (the web is a <em>very</em> different place now as it was in the 90s), the creators of CSS have not made front-end developers' lives easy when developing scalable, 'performant' products. Attempting to understand, let alone manipulate scope in CSS for example is frivolous — the control just is not there. <em>Everything</em> is global meaning it is <em>far</em> too easy for a codebase to quickly fill up with overrides of code written further up the cascade. Although this may be tameable for smaller projects, having each and every CSS value in the global namespace is problematic and if you throw theming into the mixture, you will quickly find yourself fighting a losing battle.</p>
<p>Thankfully, we have preprocessors such as Sass that equip us with features and functions to handle some of the issues aforementioned. Structuring for example is made especially easy through the ability to break style sheets into various partials that can be thus imported into one core style sheet (and therefore one HTTP request) affording control over the cascade. The ability to store values in reusable variables also makes maintaining a large codebase far more manageable, allowing developers to quickly change a value from one place, as opposed to trawling through directories to find a value that may have discrepancies – the inconsistent use of 'white', '#fff' ', '#FFF', '#FFFFFF', '#ffffff' springs to mind.</p>
<p>So can Sass help us with theming?</p>
<h3 class="as-h2">Creating a styling layer</h3>
<p>Before diving into whether SASS can help us, it is important to first create the foundation for it to do so, through what I am now going to call the 'style layer'.</p>
<p>If you are familiar with writing object-oriented CSS you will know that separating style-specific CSS from layout-specific CSS separates our concerns, allowing us to make minor superficial changes to an object (or module if you prefer) whilst ensuring the core layout, positioning and sizing remain. Of course you could pile all that code together into one class like the following:</p>
<pre><code class="css">.foo {
    // Styling
    background-color: $bg;
    color: $color;

    // Positioning
    position: fixed;
    bottom: 0;
    left: 0;
    height: 5em;
}</code></pre>
<p>But if we went ahead with the code above, as soon as we need to introduce a modifier (we are adopting the <a href="http://csswizardry.com/2013/01/mindbemding-getting-your-head-round-bem-syntax/">BEM</a> methodology for clarity) to the class <code>.foo</code>, we are forced to write code that overrides a pre-existing value:</p>
<pre><code>.foo--highlight { background-color: $bg-highlight; }</code></pre>
<p>But if we instead abstract the style layer away from the core object code, there is no longer a need to introduce overrides that more often than not lead to more <a href="http://cssguidelin.es/#specificity">specific</a> CSS – not something we should be aiming for. Instead we can create modifier classes that set the <em>initial</em> value wherever the class is used, not only reducing specificity but also giving us the ability to manipulate style values without touching the object class. This may look something like this:</p>
<pre><code class="css">.foo {
    position: fixed;
    bottom: 0;
    left: 0;
    height: 5em;
}
.foo--primary { background-color: $bg-primary; }
.foo--highlight { background-color: $bg-highlight; }</code></pre>
<h3 class="as-h2">Problems with theming</h3>
<p>So we now have clean CSS with low specificity. We do not however have CSS that can be easily themed. As soon as a theme needs to add its <em>own</em> primary or highlight background colours (following on with the previous example) we are immediately provoking a scrap with our old mate – specificity.</p>
<p>Previously when introducing themes for our internal SaaS product <a href="http://www.twineintranet.com/">Twine</a>, my perhaps knee-jerk inclination was to create a new style sheet that would be loaded into the page after the main style sheet, containing any theme-specific modifier classes (like the ones above). This is however problematic, as classes lose their proximity to the actual object, meaning it becomes far more difficult to understand the modifiers that are actually available for styling (as they are now in separate directories). I, for example, may have forgotten about the 'highlight' modifier class I wrote for one particular theme, meaning when the time comes to create an entirely new theme, there is a chance I will miss said class entirely, leaving an object without any recognisable styling.</p>
<p>There is also the added task of having to update each theme file with any new objects developed into the browser, slowing down our workflow. What we really need is to maintain the abstracted style layer whilst maintaining the relationship of the object class and its modifier classes.</p>
<h3 class="as-h2">Creating a theme layer</h3>
<p>Fortunately, with Sass, instead of needing a theme file, we can tie the style layer to a broader theme layer attached to the 'html' element whilst maintaining class proximity via the <a href="http://thesassway.com/intermediate/referencing-parent-selectors-using-ampersand">ampersand character</a>. This may look something like this:</p>
<pre><code class="css">.foo { ... }
.foo--highlight { 
    .t-default &amp; { background-color: $t-default-bg-highlight; }
    .t-alt &amp; { background-color: $t-alt-bg-highlight; }
}</code></pre>
<p>Which would compile into the following CSS:</p>
<pre><code class="css">.foo { ... }
.t-default .foo--highlight {
    background-color: #BADA55;
}
.t-alt .foo--highlight {
    background-color: #FAFAFA;
}</code></pre>
<p>Not only does this have the added benefit of eliminating one HTTP request (better for performance), it is now far more manageable as the modifier class clearly has a relationship with the object class – in this case we are simply adding a highlight background colour for each theme. Although prepending a theme class before another class name does increase our CSS's specificity (by one), we now have a consistent layer of non-obtrusive classes that can be easily managed through variables. </p>
<h3 class="as-h2">Hold your horses, what if I have lots of themes?</h3>
<p>A valid observation. It is possible but not particular likely you are going to go to the effort of creating an entire theme layer and only introduce two or three themes. Twine, for example, contains eight themes (and counting!) so adding a style modifier to an object is a cumbersome task as values need to be set for each and every theme available to the user.</p>
<p>Fortunately Sass (v3.3+) comes with a feature called <a href="http://thesassway.com/news/sass-3-3-released#maps">Maps</a> that allow us to loop through variable lists – essentially an array of values. The keen eyed of you will have noticed that in the example above I no longer have a generic <code>$bg-highlight</code> variable that stores the project's highlight colour. Instead I tie a unique variable to each theme.</p>
<p>With Sass maps we can quickly turn such variables into a list that can be looped through eliminating the need for us to explicitly declare each theme when styling an object. This may look something like this:</p>
<pre><code class="css">$bg-highlight: (
    t-default: (bgcolor: $t-default-bg-highlight),
    t-accentuate: (bgcolor: $t-accentuate-bg-highlight),
    t-bluesky: (bgcolor: $t-bluesky-bg-highlight),
    t-dusk: (bgcolor: $t-dusk-bg-highlight),
    t-midnight: (bgcolor: $t-midnight-bg-highlight),
    t-sleek: (bgcolor: $t-sleek-bg-highlight),
    t-solar: (bgcolor: $t-solar-bg-highlight),
    t-sunrise: (bgcolor: $t-sunrise-bg-highlight),
);</code></pre>
<p>Using the above list now enables use to refactor the previous example to be far more manageable and lean:</p>
<pre><code class="css">.foo--highlight {
     @each $theme, $map in $bg-highlight {
        $bg-highlight: map-get($map, bgcolor);
        .#{$theme} &amp; {
            background-color: $bg-highlight;
        }
    };
}</code></pre>
<p>Which, when compiled, produces the exact same CSS for each theme as before but saves us some of the leg work!</p>
<h3 class="as-h2">Expanding this approach</h3>
<p>Although I have used a background colour as an example throughout this post, it should be said that this can be extended to cover a variety of values that relate to each other. There is no need to create a new map and loop for each and every property we need to pull for a theme, we can simply relate two map keys together. In the map below for example we are storing values that will be used to generate a gradient:</p>
<pre><code class="css">$brand-gradient: (
    t-default: (
        startcolor: $t-default-header-gradient-start,
        endcolor: $t-default-header-gradient-end,
    ),
    t-dusk: (
        startcolor: $t-dusk-header-gradient-start,
        endcolor: $t-dusk-header-gradient-end,
    ),
    t-midnight: (
        startcolor: $t-midnight-header-gradient-start,
        endcolor: $t-midnight-header-gradient-end,
    ),
    t-sleek: (
        startcolor: $t-sleek-header-gradient-start,
        endcolor: $t-sleek-header-gradient-end,
    ),
    t-sunrise: (
        startcolor: $t-sunrise-header-gradient-start,
        endcolor: $t-sunrise-header-gradient-end,
    ),
);</code></pre>
<p>As before, to access these values we can use a loop:</p>
<pre><code class="css">.foo--gradient {
    @each $theme, $map in $brand-gradient {
        .#{$theme} &amp; {
            $start-color: map-get($map, startcolor);
            $end-color: map-get($map, endcolor);

            background-image: linear-gradient(to right, $start-color 0%, $end-color 100%);
        }
    }
}</code></pre>
<p>Controlling themes in Sass is by no means perfect – repeating the loop when setting something simple like a colour can become somewhat arduous (using a mixin unfortunately doesn't work as of writing) – however it is a significant step forward in terms of maintaining control of specificity in large projects whilst having fun with themes!</p>
<h3 class="as-h2">Afterthought (31/03/2015)</h3>
<p>Having experimented with this approach over the past month it is worth noting that it is quite easy to unknowingly increase the weight of your site's CSS without diligence. Once compiled and gzipped Twine's CSS weighed in at a modest 33kb, however we did hit the fatuous <a href="http://support.microsoft.com/en-gb/kb/262161">IE selector limit</a>. If IE7-9 support is a must, I recommend <a href="https://github.com/paulyoung/bless.js">bless.js</a> as a workaround (Grunt/Gulp integration available). </p>

                        <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'joshjohnsonportfolio';
    var disqus_identifier = "/theming-with-sass";

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
                    </div>
                </article>
            </div>
        </div>
    </main>
    <script type="text/javascript" async="true">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-31575166-1']);
        _gaq.push(['_setDomainName', 'joshuajohnson.co.uk']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
</body>
</html>
